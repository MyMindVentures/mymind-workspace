{
  "apiVersion": "v1",
  "spec": {
    "kind": "CombinedService",
    "name": "n8n-enterprise",
    "billing": {
      "deploymentPlan": "nf-compute-50"
    },
    "deployment": {
      "instances": 1,
      "docker": {
        "configType": "customCommand"
      },
      "internal": {
        "id": "n8n-enterprise",
        "branch": "master",
        "projectType": "dockerfile",
        "dockerfile": {
          "buildEngine": "kaniko",
          "dockerFilePath": "/container/Dockerfile.n8n-enterprise",
          "dockerWorkDir": "/"
        }
      }
    },
    "ports": [
      {
        "name": "web",
        "internalPort": 5678,
        "public": true,
        "protocol": "HTTP",
        "security": {
          "policies": []
        },
        "domains": []
      }
    ],
    "runtimeEnvironment": {
      "WEBHOOK_URL": "https://{{SERVICE_DOMAIN}}/",
      "N8N_EDITOR_BASE_URL": "https://{{SERVICE_DOMAIN}}/",
      "OPENAI_API_KEY": "{{OPENAI_API_KEY}}",
      "ANTHROPIC_API_KEY": "{{ANTHROPIC_API_KEY}}",
      "DB_TYPE": "postgresdb",
      "DB_POSTGRESDB_HOST": "{{POSTGRES_HOST}}",
      "DB_POSTGRESDB_PORT": "5432",
      "DB_POSTGRESDB_DATABASE": "n8n",
      "DB_POSTGRESDB_USER": "{{POSTGRES_USER}}",
      "DB_POSTGRESDB_PASSWORD": "{{POSTGRES_PASSWORD}}",
      "N8N_AI_ENABLED": "true",
      "N8N_TEMPLATES_ENABLED": "true",
      "EXECUTIONS_DATA_SAVE_ON_ERROR": "all",
      "EXECUTIONS_DATA_SAVE_ON_SUCCESS": "all",
      "N8N_METRICS": "true"
    },
    "healthChecks": [
      {
        "name": "http-health",
        "path": "/healthz",
        "port": 5678,
        "protocol": "HTTP",
        "interval": 30,
        "timeout": 10,
        "failureThreshold": 3,
        "successThreshold": 1,
        "initialDelay": 30
      }
    ]
  },
  "description": "n8n workflow automation with AI agents, LangChain, OpenAI, and vector stores"
}
